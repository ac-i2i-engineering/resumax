{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="{% static 'index.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" integrity="sha384-tViUnnbYAV00FLIhhi3v/dWt3Jxw4gZQcNoSCxCIFNJVCx7/D55/wXsrNIRANwdD" crossorigin="anonymous">
    <!-- Markdown-it library for converting markdown to HTML -->
    <script src="https://cdn.jsdelivr.net/npm/markdown-it@14.1.0/dist/markdown-it.min.js"></script>
    <title>ResuMax</title>
  </head>
  <body>
    <nav class="side-panel" id="side-panel">
      <div class="side-panel-header">
        <h1 class="nav-app-name">ResuMax</h1>
        <button id="close-side-panel-btn" class="side-panel-toggler-btn">☰</button>
      </div>
      <div class="side-panel-body">
        <button id="create-thread-btn">
          <i class="bi bi-plus-circle"></i>
          <span>New Chat</span>
        </button>
        <div id="chat-history-range-container">
          <div class="history-range">
            <h3 class="history-range-title">Today</h3>
            <div class="thread-container">
                  <p class="thread-title">lorem ipsum sit do la mere ipsum sit do la mere
                    <span>
                      <i class="bi bi-trash"></i>
                    </span>
                  </p>
            </div>
          </div>
        </div>
      </div>
      <div class="side-panel-footer">
        {% comment %} Settings and user options {% endcomment %}
        <p>
          <a class="logout-btn" href="{% url 'logout' %}"><span>Logout</span></a>
        </p>
        <p>
          <a class="password-reset-btn" href="{% url 'change-password' %}"><span>Change Password</span></a>
        </p>
        <p>© ResuMax 2025</p>
      </div>
    </nav>
    <main class="main-container" id="main-container">
        <nav class="top-navbar">
          <div class="top-navbar-body">
            <button id="open-side-panel-btn" class="side-panel-toggler-btn active">☰</button>
            <h1 class="nav-app-name active">ResuMax</h1>
            <div class="user-section">
              <p>{{ user.username }}</p>
              <!--Profile Picture drop down menu-->            
              <img src="{% static 'images/profile-pic.png' %}"  class="user-picture" onclick="toggleMenu()">
            </div>
            <div class="sub-menu-wrap" id="subMenu">
              <div class="sub-menu">
                <div class="user-info">
                  <img src="{% static 'images/standard-pic.png' %}" class="profile-picture">
                  <h3>{{ user.username }}</h3>
                </div>
                <hr>
                <a href="" class="sub-menu-link">
                 <img src="{% static 'images/profile-pic.png' %}"> 
                 <p>My Profile</p>
                 <span>></span>
                </a>
                <a href="http://127.0.0.1:8000/auth/login/" class="sub-menu-link">
                 <img src="{% static 'images/logout.png' %}"> 
                  <p>Logout</p>
                 <span>></span>
                </a>
              </div>  
            </div>
          </div>
        </nav>
        <div class="chat-box" id="chat-box">
          <!-- sample message user and bot messages
          <div class="message user-message">
            some
          </div>
          <div class="message bot-message">
          </div>
           -->
        </div>
        <!-- user file/text input form-->
        <form class="chat-form" id="prompt-input-form" method="POST" enctype="multipart/form-data">
         {% csrf_token %}
         <input
               type="file"
               name="prompt-file"
               id="file"
               required
               accept=".pdf,.png,.jpg,.jpeg,.webp,.heic,.heif,.txt,.md,.html,.xml"
               multiple
               style="display: none"
             />
         <button type="button" id="upload-file-btn">
            <i class="bi bi-paperclip"></i>
          </button>
         <div class="user-input-container">
           <div id="input-files-preview-container" class="files-preview-container">
            <!-- sample file icon container
             <div class="file-icon-container">
                <i class="bi bi-file-earmark-pdf file-type-preview-icon"></i>
                <span class="file-name"></span>
                <i class="bi bi-x remove-file-btn"></i>
             </div>
             -->
           </div>
           <textarea type="text" name="prompt-text" id="chat-input-text" placeholder="Type a message..." rows="1"></textarea>
         </div>
         <button type="submit" id="send-btn">
          <i class="bi bi-send"></i>
         </button>
        </form>
    </main>
    <div id="side-panel-backdrop"></div>
    <script src="{% static 'index.js' %}"></script>
    <script>
      let subMenu= document.getElementById("subMenu");

      function toggleMenu(){
        subMenu.classList.toggle("open-menu");
      }
    </script>
  </body>
</html>